---
# tasks file for mongodb_repository (RedHat os_family)
- name: Add mongodb.org gpgkey
  rpm_key:
    key: https://www.mongodb.org/static/pgp/server-{{ mongodb_version }}.asc
    state: present
  register: _yum
  until: _yum is succeeded
  retries: 5

- name: Ensure MongoDB yum repository exists
  yum_repository:
    name: "mongodb-{{ mongodb_version }}"
    description: "Official MongoDB {{ mongodb_version }} yum repo"
    baseurl: "https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/{{ mongodb_version }}/x86_64/"
    gpgcheck: true
    gpgkey: "https://www.mongodb.org/static/pgp/server-{{ mongodb_version }}.asc"
  register: _yum
  until: _yum is succeeded
  retries: 5
